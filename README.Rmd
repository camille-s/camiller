---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
	fig.path = "man/figures/README-",
	message = FALSE,
	warning = FALSE,
	collapse = TRUE,
	comment = "#>",
	out.width = "100%",
	fig.showtext = TRUE
)
```
# camiller

[![Travis build status](https://travis-ci.org/camille-s/camiller.svg?branch=master)](https://travis-ci.org/camille-s/camiller)

[![AppVeyor build status](https://ci.appveyor.com/api/projects/status/github/camille-s/camiller?branch=master&svg=true)](https://ci.appveyor.com/project/camille-s/camiller)

`camiller` is a set of convenience functions, functions for working with ACS data via `tidycensus`, and a `ggplot` theme.

## Installation

Install from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("camille-s/camiller")
```

## Example

This is a basic example of two of the major functions in this package, `add_grps` and `calc_shares`:

```{r example}
library(dplyr)
library(camiller)

edu_list <- list(ages25plus = 1, less_than_high_school = 2:16,
   high_school = 17:18, some_college_or_aa = 19:21, bachelors_plus = 22:25)

edu_rates <- edu_detail %>%
  dplyr::group_by(name) %>%
  add_grps(edu_list, group = variable, moe = moe) %>%
  calc_shares(group = variable, denom = "ages25plus", moe = moe)

edu_rates
```

Plus this `ggplot` theme.

```{r chart}
library(ggplot2)
library(forcats)
library(showtext)

font_add_google("Archivo Narrow", "archivo")
showtext_auto()

edu_rates %>%
  ungroup() %>%
  filter(!is.na(share)) %>%
  arrange(variable, share) %>%
  mutate(name = as.factor(name) %>% fct_inorder() %>% fct_rev()) %>%
  mutate(variable = fct_relabel(variable, function(x) {
    stringr::str_replace_all(x, "_", " ") %>% cap_first()
    })) %>%
  mutate(variable = fct_recode(variable, "Bachelor's or higher" = "Bachelors plus", 
                               "Some college or Associate's" = "Some college or aa")) %>%
  mutate(variable = fct_rev(variable)) %>%
  ggplot(aes(x = name, y = share, fill = variable)) +
    geom_col(position = "fill", width = 0.8, alpha = 0.9) +
    scale_y_continuous(labels = scales::percent) +
    scale_fill_manual(values = c("#FBB4B9", "#F768A1", "#C51B8A", "#7A0177")) +
    labs(x = NULL, y = "Share of adults 25+", fill = "Education level", 
         title = "Educational attainment level by town", 
         subtitle = "Among adults ages 25 or over, 2016", 
         caption = "Source: US Census Bureau ACS 2016 5-year estimates") +
    theme_din(base_family = "archivo")
```

